# OpenTelemetry Collector Environment Variables Template
# Copy this file to .env and fill in your actual values
# DO NOT commit .env files to version control

# ===== SERVICE CONFIGURATION =====
# Basic service identification
SERVICE_NAME=database-intelligence-collector
SERVICE_VERSION=2.0.0
DEPLOYMENT_ENVIRONMENT=development  # development, staging, production
HOSTNAME=${HOSTNAME}

# ===== DATABASE CONNECTIONS =====
# PostgreSQL Configuration
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
POSTGRES_DB=postgres
POSTGRES_SSLMODE=disable  # disable, require, verify-ca, verify-full
POSTGRES_TLS_INSECURE=true
POSTGRES_CA_FILE=/path/to/ca.crt
POSTGRES_CERT_FILE=/path/to/client.crt
POSTGRES_KEY_FILE=/path/to/client.key

# MySQL Configuration
MYSQL_HOST=localhost
MYSQL_PORT=3306
MYSQL_USER=root
MYSQL_PASSWORD=mysql
MYSQL_DB=mysql
MYSQL_TLS_INSECURE=true
MYSQL_CA_FILE=/path/to/mysql-ca.crt

# ===== COLLECTION INTERVALS =====
# How often to collect metrics (format: 10s, 1m, 5m)
POSTGRES_COLLECTION_INTERVAL=60s
MYSQL_COLLECTION_INTERVAL=60s
POSTGRES_QUERY_INTERVAL=300s
MYSQL_QUERY_INTERVAL=300s
ENHANCED_SQL_INTERVAL=60s

# ===== OTLP CONFIGURATION =====
# OTLP Receiver Settings
OTLP_GRPC_ENDPOINT=0.0.0.0:4317
OTLP_HTTP_ENDPOINT=0.0.0.0:4318
OTLP_MAX_RECV_MSG_SIZE=32
OTLP_MAX_REQUEST_BODY_SIZE=32

# OTLP Exporter Settings (New Relic)
NEW_RELIC_OTLP_ENDPOINT=https://otlp.nr-data.net
NEW_RELIC_LICENSE_KEY=YOUR_LICENSE_KEY_HERE  # This is the ingest key for OTLP
NEW_RELIC_ACCOUNT_ID=YOUR_ACCOUNT_ID_HERE
OTLP_TIMEOUT=30s
OTLP_RETRY_INITIAL_INTERVAL=5s
OTLP_RETRY_MAX_INTERVAL=30s
OTLP_RETRY_MAX_ELAPSED_TIME=300s
OTLP_QUEUE_CONSUMERS=10
OTLP_QUEUE_SIZE=5000

# Environment-specific endpoints
STAGING_OTLP_ENDPOINT=https://staging-otlp.nr-data.net
STAGING_LICENSE_KEY=YOUR_STAGING_KEY_HERE
PROD_OTLP_ENDPOINT=https://otlp.nr-data.net
PROD_LICENSE_KEY=YOUR_PROD_KEY_HERE

# ===== RESOURCE LIMITS =====
# Memory limiter settings (in MiB)
MEMORY_LIMIT_MIB=512
MEMORY_SPIKE_LIMIT_MIB=128
MEMORY_CHECK_INTERVAL=1s
MEMORY_BALLAST_SIZE_MIB=64

# ===== BATCH PROCESSING =====
BATCH_TIMEOUT=1s
BATCH_SIZE=1024
BATCH_MAX_SIZE=2048

# ===== SAMPLING CONFIGURATION =====
# Adaptive sampling settings (for custom processors)
ADAPTIVE_SAMPLING_PERCENTAGE=10
MAX_TRACES_PER_SECOND=100
SAMPLED_CACHE_SIZE=100000
NONSAMPLED_CACHE_SIZE=100000
SELECT_SAMPLING_PERCENTAGE=5
DML_SAMPLING_PERCENTAGE=50
AUDIT_SAMPLING_PERCENTAGE=1

# ===== CIRCUIT BREAKER (for custom processors) =====
CIRCUIT_BREAKER_MAX_FAILURES=5
CIRCUIT_BREAKER_FAILURE_THRESHOLD=50
CIRCUIT_BREAKER_TIMEOUT=30s
CIRCUIT_BREAKER_RECOVERY_TIMEOUT=60s
PER_DATABASE_CIRCUIT=true
HEALTH_CHECK_INTERVAL=10s

# ===== COST CONTROL (for custom processors) =====
DAILY_BUDGET_USD=100
MONTHLY_BUDGET_USD=3000
COST_PER_GB=0.25
COST_PER_MILLION_EVENTS=2.00
COST_ALERT_THRESHOLD=80
COST_ENFORCEMENT_ENABLED=false

# ===== PLAN ANALYSIS (for custom processors) =====
ENABLE_PLAN_COLLECTION=false
PLAN_CACHE_SIZE=1000
PLAN_CACHE_ENABLED=true
PLAN_CACHE_MAX_SIZE=10000
PLAN_CACHE_TTL=3600s
ENABLE_ANONYMIZATION=true
ENABLE_PLAN_ANALYSIS=true
MAX_QUERY_LENGTH=4096

# ===== DATA VERIFICATION (for custom processors) =====
ENABLE_PII_DETECTION=true
ENABLE_DATA_VALIDATION=true
MAX_FIELD_LENGTH=1000
VERIFICATION_SAMPLE_RATE=0.1

# ===== CORRELATION (for custom processors) =====
CORRELATION_WINDOW=30s
MAX_CORRELATIONS=1000
ENABLE_TRACE_CORRELATION=true

# ===== MONITORING ENDPOINTS =====
# Prometheus exporter
PROMETHEUS_ENDPOINT=0.0.0.0:8889
PROMETHEUS_NAMESPACE=database_intelligence
PROMETHEUS_METRIC_EXPIRATION=10m
PROMETHEUS_ENABLE_OPEN_METRICS=false

# Health check
HEALTH_CHECK_ENDPOINT=0.0.0.0:13133
HEALTH_CHECK_PATH=/
HEALTH_CHECK_PIPELINE_ENABLED=true
HEALTH_CHECK_INTERVAL=5m
HEALTH_CHECK_EXPORTER_FAILURE_THRESHOLD=5

# Performance profiling
PPROF_ENDPOINT=0.0.0.0:1777
PPROF_BLOCK_PROFILE_FRACTION=0
PPROF_MUTEX_PROFILE_FRACTION=0
PPROF_SAVE_TO_FILE=

# zPages debugging
ZPAGES_ENDPOINT=0.0.0.0:55679

# ===== LOGGING CONFIGURATION =====
LOG_LEVEL=info  # debug, info, warn, error
LOG_DEVELOPMENT=false
LOG_ENCODING=json  # json, console
DEBUG_VERBOSITY=normal  # basic, normal, detailed
DEBUG_SAMPLING_INITIAL=5
DEBUG_SAMPLING_THEREAFTER=200

# ===== TELEMETRY =====
TELEMETRY_METRICS_LEVEL=basic  # none, basic, normal, detailed
TELEMETRY_METRICS_ADDRESS=0.0.0.0:8888

# ===== FILE STORAGE =====
FILE_STORAGE_DIRECTORY=/tmp/otel-storage
FILE_STORAGE_TIMEOUT=1s
FILE_STORAGE_COMPACTION_DIRECTORY=/tmp/otel-storage-compaction
FILE_STORAGE_COMPACTION_ON_START=false
FILE_STORAGE_COMPACTION_ON_REBOUND=true
FILE_STORAGE_REBOUND_THRESHOLD_MIB=100
FILE_STORAGE_REBOUND_TRIGGER_MIB=150

# ===== FILE EXPORTER (Development) =====
FILE_EXPORTER_PATH=/tmp/otel-data.json
FILE_EXPORTER_FORMAT=json

# ===== AUTHENTICATION (Optional) =====
# Basic auth
BASIC_AUTH_HTPASSWD_FILE=/etc/otelcol/auth/.htpasswd

# Bearer token
BEARER_TOKEN=
BEARER_TOKEN_FILE=

# OAuth2
OAUTH2_CLIENT_ID=
OAUTH2_CLIENT_SECRET=
OAUTH2_TOKEN_URL=
OAUTH2_SCOPE=read

# ===== GATEWAY CONFIGURATION (Optional) =====
GATEWAY_ENDPOINT=http://gateway-collector:4318
GATEWAY_TOKEN=
GATEWAY_TIMEOUT=10s